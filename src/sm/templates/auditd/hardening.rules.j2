## Auditd baseline rules - HARDENING ONLY
## Generated by sm security harden
## We do not watch log files here because we are already ingesting them via OTEL.

# 1. Identity & Credentials (User modification)
-w /etc/passwd  -p wa -k identity
-w /etc/shadow  -p wa -k identity
-w /etc/group   -p wa -k identity
-w /etc/gshadow -p wa -k identity

# 2. Privileged Access (Sudo changes)
-w /etc/sudoers -p wa -k scope
-w /etc/sudoers.d/ -p wa -k scope

# 3. Remote Access Config (SSHD changes)
-w /etc/ssh/sshd_config -p wa -k sshd_config

{% if extra_watches %}
# 4. Additional watches (custom)
{% for watch in extra_watches %}
-w {{ watch.path }} -p {{ watch.permissions }} -k {{ watch.key }}
{% endfor %}
{% endif %}

## NOTE: We explicitly DO NOT watch /var/log/auth.log or /var/log/audit/
## to prevent feedback loops and duplicate data ingestion.
